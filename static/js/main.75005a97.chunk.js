(this["webpackJsonpbc-wildfire-tracker"]=this["webpackJsonpbc-wildfire-tracker"]||[]).push([[0],{25:function(e){e.exports=JSON.parse('[{"fire_center_id":"166","id":"3","name":"Northwest"},{"fire_center_id":"165","id":"2","name":"Prince George"},{"fire_center_id":"164","id":"4","name":"Coastal"},{"fire_center_id":"163","id":"6","name":"Cariboo"},{"fire_center_id":"162","id":"5","name":"Kamloops"},{"fire_center_id":"161","id":"1","name":"Southeast"}]')},26:function(e,t,a){e.exports=a(80)},48:function(e,t,a){},49:function(e,t,a){},50:function(e,t,a){},51:function(e,t,a){},67:function(e,t,a){},68:function(e,t,a){},71:function(e,t,a){},72:function(e,t,a){},73:function(e,t,a){e.exports=a.p+"static/media/BentonSansCond-Regular.43cd4ac7.otf"},74:function(e,t,a){e.exports=a.p+"static/media/BentonSansCond-RegItalic.69a4217c.otf"},75:function(e,t,a){e.exports=a.p+"static/media/BentonSansCond-Bold.6f6753fd.otf"},76:function(e,t,a){e.exports=a.p+"static/media/BentonSansCond-BoldItalic.a6640d89.otf"},77:function(e,t,a){e.exports=a.p+"static/media/Shift-Bold.cdd38a86.otf"},78:function(e,t,a){e.exports=a.p+"static/media/Shift-BoldItalic.5c3edbfd.otf"},79:function(e,t,a){},80:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(11),i=a.n(o),s=a(12),c=a(2),l=a(3),p=a(5),u=a(4),m=a(8),d=a.n(m),f=a(6),h=a(7),g=a.n(h);a(48);var v=function(e){return"\n\t\t<div>\n\t\t\t<h3>".concat(e.GEOGRAPHIC,'</h3>\n\t\t\t<p class="status ').concat(e.FIRE_STATU.toLowerCase().replace(/\s/g,"-"),'">Status: ').concat(e.FIRE_STATU,"</p>\n\t\t\t<p>A fire of ").concat(function(e){var t=(e.CURRENT_SI/100).toFixed(2);return t<.01?"less than 0.01":t}(e)," square kilometres started on ").concat(e.ignition_date,".</p>\n\n\t\t\t<p>Suspected cause: ").concat(""===(t=e.FIRE_CAUSE)?"unknown":t.toLowerCase(),"</p>\n\t\t</div>\n\t");var t},E=(a(49),function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n.popup=new g.a.Popup({closeButton:!1,closeOnClick:!1}),n.showPopup=n.showPopup.bind(Object(f.a)(n)),n.hidePopup=n.hidePopup.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this.props.data;this.extent_calcuted=!1,this.range=this.props.range?this.props.range:[3,50],g.a.accessToken=this.props.config.accessToken,this.map=new g.a.Map({container:this.mapContainer,style:this.props.mapboxStyle,center:[this.props.center[1],this.props.center[0]],zoom:this.props.zoom}),e.features&&this.renderMap(e)}},{key:"componentDidUpdate",value:function(e){this.state.mapIsLoaded?this.props.data!==e.data&&this.map.getSource("wildfires").setData(this.props.data):this.renderMap(this.props.data)}},{key:"getExtent",value:function(e){var t=[];return e.forEach((function(e){t.push(parseFloat(e.properties.CURRENT_SI))})),[Math.min.apply(Math,t),Math.max.apply(Math,t)]}},{key:"hidePopup",value:function(){this.map.getCanvas().style.cursor="",this.popup.remove()}},{key:"mapRange",value:function(e,t,a){return t[0]+(a-e[0])*(t[1]-t[0])/(e[1]-e[0])}},{key:"prepData",value:function(e){var t=this;this.extent_calcuted||(this.extent=this.getExtent(e.features),this.extent_calcuted=!0),e.features.forEach((function(e,a){var n=t.mapRange(t.extent,t.range,e.properties.CURRENT_SI);e.properties.radius=4*Math.log(n)})),e.features.sort((function(e,t){return t.CURRENT_SI-e.CURRENT_SI}))}},{key:"setupPopupText",value:function(e){return v(e)}},{key:"showPopup",value:function(e){this.map.getCanvas().style.cursor="pointer";var t=this.setupPopupText(e.features[0].properties);this.popup.setLngLat(e.lngLat).setHTML(t).addTo(this.map)}},{key:"renderMap",value:function(e){var t=this;this.prepData(e),this.map.on("load",(function(){t.map.addSource("wildfires",{type:"geojson",data:e}),t.map.addLayer({id:"wildfires",type:"circle",source:"wildfires",paint:{"circle-color":["match",["get","FIRE_STATU"],"New","#DD2D25","Being Held","#F26B21","Under Control","#0062A3","Out","#6D6E70","green"],"circle-opacity":.7,"circle-radius":["*",["get","radius"],1],"circle-stroke-width":.5,"circle-stroke-color":"#FFF"}}),t.map.on("mouseenter","wildfires",t.showPopup),t.map.on("mouseleave","wildfires",t.hidePopup)})),this.setState({mapIsLoaded:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{ref:function(t){return e.mapContainer=t}})}}]),a}(n.Component));a(50);var y=function(e){var t=function(e){var t={out_fires:0,new_fires:0,held_fires:0,controlled_fires:0,last_update:"Waiting for data..."};if(e.data.features){var a=e.data.features,n=a.reduce((function(e,t){return e+parseFloat(t.properties.CURRENT_SI)}),0);t.km_burned=(n/100).toFixed(0),t.total_fires=a.length+1,t.last_update=a.length>0?function(e){var t=new Date(parseInt(e)),a=(n=t.getUTCMonth(),["January","February","March","April","May","June","July","August","September","October","November","December"][parseInt(n)]);var n;return"".concat(a," ").concat(t.toLocaleDateString().split("/")[1],", ").concat(t.getUTCFullYear()," at ").concat(t.toLocaleTimeString())}(a[0].properties.last_update):"Not available";for(var r=0;r<a.length;++r)"New"===a[r].properties.FIRE_STATU|"Out of Control"===a[r].properties.FIRE_STATU?t.new_fires++:"Being Held"===a[r].properties.FIRE_STATU?t.held_fires++:"Under Control"===a[r].properties.FIRE_STATU?t.controlled_fires++:t.out_fires++}return t}(e);return r.a.createElement("div",{className:"summary-box",onClick:e.toggleFireTypeHandler},r.a.createElement("h2",null,"Latest wildfire stats"),r.a.createElement("div",{className:"stat-box"},r.a.createElement("div",{className:"stat"},r.a.createElement("p",{className:"big-num new"},t.new_fires),r.a.createElement("p",{className:"label"},"New")),r.a.createElement("div",{className:"stat"},r.a.createElement("p",{className:"big-num being-held"},t.held_fires),r.a.createElement("p",{className:"label"},"Held")),r.a.createElement("div",{className:"stat"},r.a.createElement("p",{className:"big-num under-control"},t.controlled_fires),r.a.createElement("p",{className:"label"},"Controlled")),r.a.createElement("div",{className:"stat"},r.a.createElement("p",{className:"big-num out"},t.out_fires),r.a.createElement("p",{className:"label"},"Out"))),r.a.createElement("p",{className:"last-update"},"Last updated: ",t.last_update))},_=(a(51),function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).map_options={center:[53.184179,-125.652423],classField:"FIRE_STATU",maxZoom:8,minZoom:3,zoom:4},e}return Object(l.a)(a,[{key:"render",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement("h1",null,"B.C. Wildfire Tracker"),r.a.createElement(E,{center:this.map_options.center,circleMarkerClassField:this.map_options.classField,config:this.props.config,container:"mapview",data:this.props.data,mapboxStyle:this.props.mapboxStyle,maxZoom:this.map_options.maxZoom,minZoom:this.map_options.minZoom,zoom:this.map_options.zoom}),r.a.createElement(y,{data:this.props.data_all,toggleFireTypeHandler:this.props.toggleFireTypeHandler}))}}]),a}(n.Component)),b=a(24),N=a.n(b),T=(a(67),function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).mapRef=r.a.createRef(),n.popup=new g.a.Popup({closeButton:!1,closeOnClick:!1}),n.showPopup=n.showPopup.bind(Object(f.a)(n)),n.hidePopup=n.hidePopup.bind(Object(f.a)(n)),n}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.data,a=this.props.data.properties.FIRE_NUMBE;g.a.accessToken=this.props.config.accessToken,this.map=new g.a.Map({container:this.props.container,style:this.props.mapboxStyle,center:[this.props.center[1],this.props.center[0]],zoom:this.props.zoom}),this.map.on("load",(function(){e.map.addSource("fire_perim",{type:"geojson",data:t}),e.map.addLayer({id:a,type:"fill",source:"fire_perim",paint:{"fill-color":"#DD2D25","fill-opacity":.4}}),e.map.on("mouseenter",a,e.showPopup),e.map.on("mouseleave",a,e.hidePopup)}))}},{key:"hidePopup",value:function(){this.map.getCanvas().style.cursor="",this.popup.remove()}},{key:"setupPopupText",value:function(e){return'<div className="popup-text"><h3>'.concat(e.FIRE_NT_NM,"</h3><p>").concat(e.cause_detail,"</p></div>")}},{key:"showPopup",value:function(e){this.map.getCanvas().style.cursor="pointer";var t=this.setupPopupText(e.features[0].properties);this.popup.setLngLat(e.lngLat).setHTML(t).addTo(this.map)}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{ref:this.map,id:this.props.container}),r.a.createElement("pre",{id:"info"}))}}]),a}(n.Component));a(68);var S=function(e){var t=e.data.properties,a={center:[t.LATITUDE.toString(),t.LONGITUDE.toString()],classField:"fire-of-note",maxZoom:8,minZoom:4,radius:10,zoom:10};return r.a.createElement("div",{className:"fire-card"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"text"},r.a.createElement("header",null,r.a.createElement("h3",null,t.fire_name.split(" (")[0]),r.a.createElement("p",null,t.location)),r.a.createElement("div",{className:"status-box"},r.a.createElement("div",{className:"status-item"},r.a.createElement("h2",{className:"".concat(t.FIRE_STATU.replace(/\s/g,"-").toLowerCase()," big-num")},t.FIRE_STATU),r.a.createElement("p",{className:"label"},"Status")),t.containment.length>0&&r.a.createElement("div",{className:"containment-item"},r.a.createElement("h2",{className:"big-num"},"fire.containment"),r.a.createElement("p",{className:"label"},"Contained"))),r.a.createElement("div",{className:"stat-box"},r.a.createElement("div",{className:"stat"},r.a.createElement("span",{className:"started icon"}),r.a.createElement("p",null,r.a.createElement("strong",null,"Started:")),r.a.createElement("p",{className:"started-date"},"".concat(t.discovered.split("day, ")[1]))),r.a.createElement("div",{className:"stat"},r.a.createElement("span",{className:"size icon"}),r.a.createElement("p",null,r.a.createElement("strong",null,"Size:")),r.a.createElement("p",null,"".concat((t.CURRENT_SI/100).toFixed(2)," km square"))),r.a.createElement("div",{className:"stat"},r.a.createElement("span",{className:"cause icon"}),r.a.createElement("p",null,r.a.createElement("strong",null,"Cause:")),r.a.createElement("p",null,"".concat(t.cause))))),r.a.createElement(T,{center:a.center,config:e.config,container:e.container,data:e.data,mapboxStyle:e.mapboxStyle,maxZoom:a.maxZoom,minZoom:a.minZoom,range:[5,5],zoom:a.zoom})))},w=a(25),x=(a(69),a(70),a(71),{autoplay:!1,autoplaySpeed:6e3,centerMode:!0,centerPadding:"25px",dots:!0,draggable:!1,infinite:!0,lazyLoad:"ondemand",speed:500,slidesToShow:1,slidesToScroll:1}),C=function(e){return r.a.createElement("div",{className:"fon"},r.a.createElement("h1",null,"Wildfires of Note"),r.a.createElement("p",null,"Wildfires of note are those which are highly visible or that pose a potential threat to public safety. The wildfires are grouped by B.C.\u2019s regional fire centres."),r.a.createElement("p",null,"The province of B.C. is divided into six regional fire centres: Cariboo, Coastal, Kamloops, Northwest, Prince George and Southeast."),r.a.createElement(N.a,x,w.map((function(t,a){var n,o=e.data.filter((function(e){return parseInt(e.properties.ZONE)===parseInt(t.id)}));return n=o.length>0?o.map((function(t,a){return r.a.createElement(S,{className:"fire-card",attribution:e.attribution,config:e.config,container:"fon-mapview",data:o[a],fireCenter:t.id,key:"fire-card-".concat(a),mapboxStyle:e.mapboxStyle})})):r.a.createElement("p",{className:"no-fires"},"No fires of note"),r.a.createElement("div",{className:"fire-center",key:t.id},r.a.createElement("h2",{className:"fire-center"},"".concat(t.name," Fire Centre")),n)}))))},F=function(e){Object(p.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={data:[],data_all:[],data_fon:[]},e}return Object(l.a)(a,[{key:"componentDidMount",value:function(){var e=this;d.a.get(this.props.currentData).then((function(t){e.setState({data:t.data,data_all:t.data}),e.setupFiresOfNote(t.data)})),this.toggleFireTypeHandler=this.toggleFireTypeHandler.bind(this)}},{key:"setupFiresOfNote",value:function(e){var t=this,a=[],n=e;a.push(d.a.get(this.props.fonData)),a.push(d.a.get(this.props.firePerimeters)),d.a.all(a).then((function(e){var a=[],r=e.filter((function(e){return e.config.url.includes("fon.json")})),o=e.filter((function(e){return e.config.url.includes("perimeters.json")}));o=o[0].data;var i=function(e){var i=r[e].data,s=t.mergeFireDetails(i[e],n.features),c=o.filter((function(e){return e.properties.FIRE_NUMBE===s.fire_number}));c[0].properties=s,a.push(c[0])};for(var s in r)i(s);t.setState({data_fon:a})}))}},{key:"filterFireData",value:function(e){if("new"===e){var t=[];return this.state.data_all.features.forEach((function(a){var n=a.properties.FIRE_STATU.replace(/\s/g,"-").toLowerCase();n===e|"out-of-control"===n&&t.push(a)})),t}return this.state.data_all.features.filter((function(t){return t.properties.FIRE_STATU.replace(/\s/g,"-").toLowerCase()===e}))}},{key:"mergeFireDetails",value:function(e,t){var a;return t.forEach((function(t){t.properties.FIRE_NT_ID===e.fire_id&&(a=Object(s.a)(Object(s.a)({},e),t.properties))})),a}},{key:"toggleFireTypeHandler",value:function(e){var t={type:"FeatureCollection"},a=e.target.className.split(" ")[1];a===this.state.data_displayed?(t=this.state.data_all,a=null):t.features=this.filterFireData(a),this.setState({data_displayed:a,data:t})}},{key:"render",value:function(){return r.a.createElement(n.Fragment,null,r.a.createElement(_,{config:this.props.mapboxConfig,data:this.state.data,data_all:this.state.data_all,mapboxStyle:this.props.mapboxStyle,tiles:this.props.tiles,toggleFireTypeHandler:this.toggleFireTypeHandler}),r.a.createElement(C,{config:this.props.mapboxConfig,data:this.state.data_fon,mapboxStyle:this.props.mapboxStyle}))}}]),a}(n.Component),k=(a(72),{accessToken:"pk.eyJ1IjoibmdyaWZmaXRocy1wb3N0bWVkaWEiLCJhIjoiY2p5eWluaDR1MHoycTNpbnZhYnE1ZGJ5YyJ9.ky9G5qVIJn0gz_y7tULp6Q"});var I=function(){return r.a.createElement(F,{fonData:"https://storage.googleapis.com/wildfire_data/fon.json",currentData:"https://storage.googleapis.com/wildfire_data/wildfires.json",firePerimeters:"https://storage.googleapis.com/wildfire_data/perimeters.json",mapboxConfig:k,mapboxStyle:"mapbox://styles/mapbox/outdoors-v11"})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(73),a(74),a(75),a(76),a(77),a(78),a(79);i.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[26,1,2]]]);
//# sourceMappingURL=main.75005a97.chunk.js.map